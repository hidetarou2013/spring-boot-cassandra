CREATE KEYSPACE IF NOT EXISTS my_keyspace WITH replication = {'class': 'SimpleStrategy', 'replication_factor': '1'}  AND durable_writes = true;

USE my_keyspace;

DROP TABLE IF EXISTS my_keyspace.customer;
CREATE TABLE IF NOT EXISTS my_keyspace.customer(
  companyCode varchar,
  logicalDeleteCode varchar,
  customerCode varchar,
  customerName varchar,
  customerNameKana varchar,
  zipcode varchar,
  address varchar,
  telNo varchar,
  faxNo varchar,
  emailAddress varchar,
  contractSectionCode varchar,
  contractEmployeeCode varchar,
  customerPersonalBusinessDivCode int,
  exitDivCode int,
  registDate varchar,
  updateDate varchar,
  PRIMARY KEY ( (companyCode,customerCode) )
);

DROP TABLE IF EXISTS my_keyspace.customernomanage;
CREATE TABLE IF NOT EXISTS my_keyspace.customernomanage(
  companyCode varchar,
  logicalDeleteCode varchar,
  lastCustomerCode varchar,
  PRIMARY KEY ( (companyCode) )
);

INSERT INTO customernomanage (companyCode,lastCustomerCode) VALUES('0000000000000000','1');

DROP TABLE IF EXISTS my_keyspace.customerOptionInfo;
CREATE TABLE IF NOT EXISTS my_keyspace.customerOptionInfo(
  companyCode varchar,
  logicalDeleteCode varchar,
  customerCode varchar,
  optionNo int,
  optioninfo varchar,
  PRIMARY KEY ( (companyCode,customerCode,optionNo) )
);


DROP TABLE IF EXISTS my_keyspace.MLabel;
CREATE TABLE IF NOT EXISTS my_keyspace.MLabel
(
	companyCode text,
	parentLabelCode text,
	labelCode text,
	labelName text,
	labelDisplayOrder int,
	level1 int ,
	level2 int ,
	level3 int ,
	level4 int ,
	level5 int ,
	analizeFlag int,
	color text,
	logicalDeleteDiv int,
	PRIMARY KEY ((companyCode),parentLabelCode,labelCode,labelDisplayOrder)
)
WITH CLUSTERING ORDER BY (parentLabelCode DESC,labelCode DESC,labelDisplayOrder DESC);

CREATE INDEX my_keyspace_MLabel_labelName ON my_keyspace.MLabel ( labelName );


INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0001', 'A','#FF0000','0000',  1, 1, 0,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0002', 'A-1','#FF0000','0001',  2, 0, 1,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0003', 'A-2','#FF0000','0001',  3, 0, 2,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0004', 'B','#FF0000','0000',  4, 2, 0,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0005', 'B-1','#FF0000','0004',  5, 0, 1,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0006', 'B-2','#FF0000','0004',  6, 0, 2,0,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0007', 'B-2-1','#FF0000','0006',  7, 0, 0,1,0,0,0,0);
INSERT INTO my_keyspace.MLabel (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv) VALUES ('AABBCC0000000001',  '0008', 'C','#FF0000','0000',  8, 3, 0,0,0,0,0,0);

DROP TABLE IF EXISTS my_keyspace.MLabel0307;
CREATE TABLE IF NOT EXISTS my_keyspace.MLabel0307
(
	companyCode varchar,
	parentLabelCode varchar,
	labelCode varchar,
	labelDisplayOrder int,
	labelName text,
	level1 int ,
	level2 int ,
	level3 int ,
	level4 int ,
	level5 int ,
	analizeFlag int,
	color text,
	logicalDeleteDiv int,
	createEmployeeCode varchar,
	createDateTime timestamp,
	updateEmployeeCode varchar,
	updateDateTime timestamp,
	PRIMARY KEY ((companyCode),parentLabelCode,labelCode,labelDisplayOrder)
)
WITH CLUSTERING ORDER BY (parentLabelCode DESC,labelCode DESC,labelDisplayOrder DESC);

CREATE INDEX my_keyspace_MLabel0307_labelName ON my_keyspace.MLabel0307 ( labelName );

INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0001', 'A','#FF0000','0000',  1, 1, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0002', 'A-1','#FF0000','0001',  2, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0003', 'A-2','#FF0000','0001',  3, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0004', 'B','#FF0000','0000',  4, 2, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0005', 'B-1','#FF0000','0004',  5, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0006', 'B-2','#FF0000','0004',  6, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0007', 'B-2-1','#FF0000','0006',  7, 0, 0,1,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  '0008', 'C','#FF0000','0000',  8, 3, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');

SELECT * FROM MLabel0307;

DROP TABLE IF EXISTS my_keyspace.MLabel0307_2;
CREATE TABLE IF NOT EXISTS my_keyspace.MLabel0307_2
(
	companyCode varchar,
	parentLabelCode timeuuid,
	labelCode timeuuid,
	labelDisplayOrder int,
	labelName text,
	level1 int ,
	level2 int ,
	level3 int ,
	level4 int ,
	level5 int ,
	analizeFlag int,
	color text,
	logicalDeleteDiv int,
	createEmployeeCode varchar,
	createDateTime timestamp,
	updateEmployeeCode varchar,
	updateDateTime timestamp,
	PRIMARY KEY ((companyCode),parentLabelCode,labelCode,labelDisplayOrder)
)
WITH CLUSTERING ORDER BY (parentLabelCode DESC,labelCode DESC,labelDisplayOrder DESC);

CREATE INDEX my_keyspace_MLabel0307_2_labelName ON my_keyspace.MLabel0307_2 ( labelName );

delete from MLabel0307_2 where companycode = 'AABBCC0000000001';
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 01:00:06+0000'), 'A','#FF0000',minTimeuuid('2017-01-01 00:00:06+0000'),  1, 1, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 02:00:06+0000'), 'A-1','#FF0000',minTimeuuid('2017-03-07 01:00:06+0000'),  2, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 03:00:06+0000'), 'A-1','#FF0000',minTimeuuid('2017-03-07 01:00:06+0000'),  3, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 04:00:06+0000'), 'B','#FF0000',minTimeuuid('2017-01-01 00:00:06+0000'),  4, 2, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 05:00:06+0000'), 'B-1','#FF0000',minTimeuuid('2017-03-07 04:00:06+0000'),  5, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 06:00:06+0000'), 'B-2','#FF0000',minTimeuuid('2017-03-07 04:00:06+0000'),  6, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 07:00:06+0000'), 'B-2-1','#FF0000',minTimeuuid('2017-03-07 06:00:06+0000'),  7, 0, 0,1,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_2 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  minTimeuuid('2017-03-07 08:00:06+0000'), 'C','#FF0000',minTimeuuid('2017-01-01 00:00:06+0000'),  8, 3, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');

select companycode,toTimestamp(parentLabelCode),toTimestamp(labelcode),labelName,labelDisplayOrder,level1,level2,level3 from my_keyspace.MLabel0307_2 where companycode = 'AABBCC0000000001' ;

DROP TABLE IF EXISTS my_keyspace.MLabel0307_3;
CREATE TABLE IF NOT EXISTS my_keyspace.MLabel0307_3
(
	companyCode varchar,
	parentLabelCode int,
	labelCode int,
	labelDisplayOrder int,
	labelName text,
	level1 int ,
	level2 int ,
	level3 int ,
	level4 int ,
	level5 int ,
	analizeFlag int,
	color text,
	logicalDeleteDiv int,
	createEmployeeCode varchar,
	createDateTime timestamp,
	updateEmployeeCode varchar,
	updateDateTime timestamp,
	PRIMARY KEY ((companyCode),parentLabelCode,labelCode,labelDisplayOrder)
)
WITH CLUSTERING ORDER BY (parentLabelCode DESC,labelCode DESC,labelDisplayOrder DESC);

CREATE INDEX my_keyspace_MLabel0307_3_labelName ON my_keyspace.MLabel0307_3 ( labelName );

INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  1, 'A','#FF0000',0,  1, 1, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  2, 'A-1','#FF0000',1,  2, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  3, 'A-2','#FF0000',1,  3, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  4, 'B','#FF0000',0,  4, 2, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  5, 'B-1','#FF0000',4,  5, 0, 1,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  6, 'B-2','#FF0000',4,  6, 0, 2,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  7, 'B-2-1','#FF0000',6,  7, 0, 0,1,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');
INSERT INTO my_keyspace.MLabel0307_3 (companyCode, labelCode, labelName, color,parentLabelCode,labelDisplayOrder, level1, level2, level3, level4, level5, analizeFlag,logicalDeleteDiv,createEmployeeCode,createDateTime,updateEmployeeCode,updateDateTime) VALUES ('AABBCC0000000001',  8, 'C','#FF0000',0,  8, 3, 0,0,0,0,0,0,'user01','2017-03-07','user02','2017-03-07');

SELECT * FROM MLabel0307_3;

